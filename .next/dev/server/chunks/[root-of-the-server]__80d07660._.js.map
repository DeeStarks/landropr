{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/deestarks/Desktop/landrop/lib/file-store.ts"],"sourcesContent":["export interface FileItem {\n  id: string\n  name: string\n  originalName: string\n  size: number\n  compressedSize: number\n  type: string\n  folderId: string | null\n  createdAt: Date\n  data: string // base64 compressed data\n}\n\nexport interface Folder {\n  id: string\n  name: string\n  parentId: string | null\n  createdAt: Date\n}\n\n// In-memory store (persists during server runtime)\nconst files: Map<string, FileItem> = new Map()\nconst folders: Map<string, Folder> = new Map()\n\n// Initialize with root folder\nfolders.set(\"root\", {\n  id: \"root\",\n  name: \"Root\",\n  parentId: null,\n  createdAt: new Date(),\n})\n\nexport function getFiles(folderId: string | null = null): FileItem[] {\n  return Array.from(files.values())\n    .filter((f) => f.folderId === folderId)\n    .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime())\n}\n\nexport function getAllFiles(): FileItem[] {\n  return Array.from(files.values()).sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime())\n}\n\nexport function getFile(id: string): FileItem | undefined {\n  return files.get(id)\n}\n\nexport function addFile(file: FileItem): void {\n  files.set(file.id, file)\n}\n\nexport function deleteFile(id: string): boolean {\n  return files.delete(id)\n}\n\nexport function getFolders(parentId: string | null = null): Folder[] {\n  return Array.from(folders.values())\n    .filter((f) => f.parentId === parentId && f.id !== \"root\")\n    .sort((a, b) => a.name.localeCompare(b.name))\n}\n\nexport function getFolder(id: string): Folder | undefined {\n  return folders.get(id)\n}\n\nexport function addFolder(folder: Folder): void {\n  folders.set(folder.id, folder)\n}\n\nexport function deleteFolder(id: string): boolean {\n  // Delete all files in folder\n  const folderFiles = getFiles(id)\n  folderFiles.forEach((f) => files.delete(f.id))\n\n  // Delete all subfolders recursively\n  const subfolders = getFolders(id)\n  subfolders.forEach((sf) => deleteFolder(sf.id))\n\n  return folders.delete(id)\n}\n\nexport function getBreadcrumbs(folderId: string | null): Folder[] {\n  const breadcrumbs: Folder[] = []\n  let currentId = folderId\n\n  while (currentId) {\n    const folder = folders.get(currentId)\n    if (folder) {\n      breadcrumbs.unshift(folder)\n      currentId = folder.parentId\n    } else {\n      break\n    }\n  }\n\n  return breadcrumbs\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAmBA,mDAAmD;AACnD,MAAM,QAA+B,IAAI;AACzC,MAAM,UAA+B,IAAI;AAEzC,8BAA8B;AAC9B,QAAQ,GAAG,CAAC,QAAQ;IAClB,IAAI;IACJ,MAAM;IACN,UAAU;IACV,WAAW,IAAI;AACjB;AAEO,SAAS,SAAS,WAA0B,IAAI;IACrD,OAAO,MAAM,IAAI,CAAC,MAAM,MAAM,IAC3B,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,UAC7B,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,SAAS,CAAC,OAAO,KAAK,EAAE,SAAS,CAAC,OAAO;AAC/D;AAEO,SAAS;IACd,OAAO,MAAM,IAAI,CAAC,MAAM,MAAM,IAAI,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,SAAS,CAAC,OAAO,KAAK,EAAE,SAAS,CAAC,OAAO;AAC9F;AAEO,SAAS,QAAQ,EAAU;IAChC,OAAO,MAAM,GAAG,CAAC;AACnB;AAEO,SAAS,QAAQ,IAAc;IACpC,MAAM,GAAG,CAAC,KAAK,EAAE,EAAE;AACrB;AAEO,SAAS,WAAW,EAAU;IACnC,OAAO,MAAM,MAAM,CAAC;AACtB;AAEO,SAAS,WAAW,WAA0B,IAAI;IACvD,OAAO,MAAM,IAAI,CAAC,QAAQ,MAAM,IAC7B,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,YAAY,EAAE,EAAE,KAAK,QAClD,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;AAC/C;AAEO,SAAS,UAAU,EAAU;IAClC,OAAO,QAAQ,GAAG,CAAC;AACrB;AAEO,SAAS,UAAU,MAAc;IACtC,QAAQ,GAAG,CAAC,OAAO,EAAE,EAAE;AACzB;AAEO,SAAS,aAAa,EAAU;IACrC,6BAA6B;IAC7B,MAAM,cAAc,SAAS;IAC7B,YAAY,OAAO,CAAC,CAAC,IAAM,MAAM,MAAM,CAAC,EAAE,EAAE;IAE5C,oCAAoC;IACpC,MAAM,aAAa,WAAW;IAC9B,WAAW,OAAO,CAAC,CAAC,KAAO,aAAa,GAAG,EAAE;IAE7C,OAAO,QAAQ,MAAM,CAAC;AACxB;AAEO,SAAS,eAAe,QAAuB;IACpD,MAAM,cAAwB,EAAE;IAChC,IAAI,YAAY;IAEhB,MAAO,UAAW;QAChB,MAAM,SAAS,QAAQ,GAAG,CAAC;QAC3B,IAAI,QAAQ;YACV,YAAY,OAAO,CAAC;YACpB,YAAY,OAAO,QAAQ;QAC7B,OAAO;YACL;QACF;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///home/deestarks/Desktop/landrop/lib/compression.ts"],"sourcesContent":["import pako from \"pako\"\n\nexport function compressData(data: Uint8Array): Uint8Array {\n  return pako.deflate(data, { level: 9 })\n}\n\nexport function decompressData(data: Uint8Array): Uint8Array {\n  return pako.inflate(data)\n}\n\nexport function uint8ArrayToBase64(bytes: Uint8Array): string {\n  let binary = \"\"\n  const len = bytes.byteLength\n  for (let i = 0; i < len; i++) {\n    binary += String.fromCharCode(bytes[i])\n  }\n  return btoa(binary)\n}\n\nexport function base64ToUint8Array(base64: string): Uint8Array {\n  const binaryString = atob(base64)\n  const len = binaryString.length\n  const bytes = new Uint8Array(len)\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binaryString.charCodeAt(i)\n  }\n  return bytes\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,SAAS,aAAa,IAAgB;IAC3C,OAAO,oKAAI,CAAC,OAAO,CAAC,MAAM;QAAE,OAAO;IAAE;AACvC;AAEO,SAAS,eAAe,IAAgB;IAC7C,OAAO,oKAAI,CAAC,OAAO,CAAC;AACtB;AAEO,SAAS,mBAAmB,KAAiB;IAClD,IAAI,SAAS;IACb,MAAM,MAAM,MAAM,UAAU;IAC5B,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,IAAK;QAC5B,UAAU,OAAO,YAAY,CAAC,KAAK,CAAC,EAAE;IACxC;IACA,OAAO,KAAK;AACd;AAEO,SAAS,mBAAmB,MAAc;IAC/C,MAAM,eAAe,KAAK;IAC1B,MAAM,MAAM,aAAa,MAAM;IAC/B,MAAM,QAAQ,IAAI,WAAW;IAC7B,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,IAAK;QAC5B,KAAK,CAAC,EAAE,GAAG,aAAa,UAAU,CAAC;IACrC;IACA,OAAO;AACT"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///home/deestarks/Desktop/landrop/app/api/files/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { addFile, getFiles, getAllFiles, type FileItem } from \"@/lib/file-store\"\nimport { compressData, uint8ArrayToBase64 } from \"@/lib/compression\"\n\nexport async function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams\n  const folderId = searchParams.get(\"folderId\")\n\n  const files = folderId === \"all\" ? getAllFiles() : getFiles(folderId)\n\n  // Return files without the data field for listing\n  const filesWithoutData = files.map(({ data, ...rest }) => rest)\n\n  return NextResponse.json(filesWithoutData)\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData()\n    const file = formData.get(\"file\") as File\n    const folderId = formData.get(\"folderId\") as string | null\n\n    if (!file) {\n      return NextResponse.json({ error: \"No file provided\" }, { status: 400 })\n    }\n\n    const arrayBuffer = await file.arrayBuffer()\n    const uint8Array = new Uint8Array(arrayBuffer)\n\n    // Compress the file data\n    const compressed = compressData(uint8Array)\n    const base64Data = uint8ArrayToBase64(compressed)\n\n    const fileItem: FileItem = {\n      id: crypto.randomUUID(),\n      name: file.name,\n      originalName: file.name,\n      size: file.size,\n      compressedSize: compressed.length,\n      type: file.type || \"application/octet-stream\",\n      folderId: folderId || null,\n      createdAt: new Date(),\n      data: base64Data,\n    }\n\n    addFile(fileItem)\n\n    const { data, ...fileWithoutData } = fileItem\n\n    return NextResponse.json(fileWithoutData)\n  } catch {\n    return NextResponse.json({ error: \"Failed to upload file\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,MAAM,WAAW,aAAa,GAAG,CAAC;IAElC,MAAM,QAAQ,aAAa,QAAQ,IAAA,gJAAW,MAAK,IAAA,6IAAQ,EAAC;IAE5D,kDAAkD;IAClD,MAAM,mBAAmB,MAAM,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,MAAM,GAAK;IAE1D,OAAO,2JAAY,CAAC,IAAI,CAAC;AAC3B;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAC1B,MAAM,WAAW,SAAS,GAAG,CAAC;QAE9B,IAAI,CAAC,MAAM;YACT,OAAO,2JAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,cAAc,MAAM,KAAK,WAAW;QAC1C,MAAM,aAAa,IAAI,WAAW;QAElC,yBAAyB;QACzB,MAAM,aAAa,IAAA,+IAAY,EAAC;QAChC,MAAM,aAAa,IAAA,qJAAkB,EAAC;QAEtC,MAAM,WAAqB;YACzB,IAAI,OAAO,UAAU;YACrB,MAAM,KAAK,IAAI;YACf,cAAc,KAAK,IAAI;YACvB,MAAM,KAAK,IAAI;YACf,gBAAgB,WAAW,MAAM;YACjC,MAAM,KAAK,IAAI,IAAI;YACnB,UAAU,YAAY;YACtB,WAAW,IAAI;YACf,MAAM;QACR;QAEA,IAAA,4IAAO,EAAC;QAER,MAAM,EAAE,IAAI,EAAE,GAAG,iBAAiB,GAAG;QAErC,OAAO,2JAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAM;QACN,OAAO,2JAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}